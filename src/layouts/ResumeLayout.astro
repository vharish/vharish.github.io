---
import BaseHead from '../components/BaseHead.astro';
import Footer from '../components/Footer.astro';
import Header from '../components/Header.astro';

interface Props {
	frontmatter: any;
}

const { frontmatter } = Astro.props;
---

<!doctype html>
<html lang="en">
	<head>
		<BaseHead title={`CV | ${frontmatter.name}`} description={`Resume of ${frontmatter.name}`} />
		<style>
			:root {
				--bg-white: #ffffff;
				--sidebar-bg: #f8fafc;
				--text-main: #1e293b;
				--text-muted: #475569;
				--accent: #2337ff;
			}

			body {
				background: #f1f5f9;
				margin: 0;
				padding: 0;
				font-family: 'Inter', system-ui, sans-serif;
			}

			/* Web View: Fixed-width A4 look */
			.page {
				width: 210mm;
				min-height: 297mm;
				padding: 0;
				margin: 40px auto;
				background: var(--bg-white);
				box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.1), 0 8px 10px -6px rgba(0, 0, 0, 0.1);
				display: flex;
				overflow: hidden;
				border-radius: 8px;
			}

			@media print {
				/* Hide everything except the resume container */
				header, footer, .download-btn, nav {
					display: none !important;
				}

				@page {
					size: A4;
					margin: 0;
				}

				body {
					background: white !important;
					margin: 0 !important;
					padding: 0 !important;
				}

				.page {
					margin: 0 !important;
					padding: 0 !important;
					box-shadow: none !important;
					border: none !important;
					width: 210mm !important;
					height: 100% !important;
					display: flex !important;
					border-radius: 0 !important;
				}

				.sidebar {
					background-color: var(--sidebar-bg) !important;
					-webkit-print-color-adjust: exact !important;
					print-color-adjust: exact !important;
					padding-top: 15mm !important;
				}
				
				.main-content {
					padding-top: 15mm !important;
				}
			}

			/* Sidebar Styles */
			.sidebar {
				width: 32%;
				background-color: var(--sidebar-bg);
				padding: 40px 25px;
				border-right: 1px solid #e2e8f0;
				flex-shrink: 0;
			}

			.main-content {
				width: 68%;
				padding: 40px 35px;
				flex-grow: 1;
			}

			h2 {
				font-size: 11pt;
				font-weight: 800;
				text-transform: uppercase;
				letter-spacing: 0.05em;
				color: var(--text-main);
				border-bottom: 2px solid var(--accent);
				padding-bottom: 4px;
				margin-bottom: 18px;
				margin-top: 30px;
			}

			.sidebar h2 { margin-top: 0; }

			h1 {
				font-size: 26pt;
				font-weight: 900;
				color: var(--text-main);
				margin: 0;
				line-height: 1;
			}

			.role-title {
				font-size: 13pt;
				color: var(--accent);
				font-weight: 600;
				margin-top: 6px;
				margin-bottom: 25px;
			}

			.contact-item {
				font-size: 9pt;
				margin-bottom: 15px;
				color: var(--text-muted);
			}

			.contact-item strong {
				color: var(--text-main);
				display: block;
				text-transform: uppercase;
				font-size: 7pt;
				letter-spacing: 0.05em;
			}

			.skill-group { margin-bottom: 20px; }
			.skill-group-title { font-weight: 700; font-size: 8pt; text-transform: uppercase; color: var(--text-main); margin-bottom: 8px; }
			.skill-tags { display: flex; flex-wrap: wrap; gap: 6px; }
			.skill-tag { font-size: 8pt; background: #fff; border: 1px solid #e2e8f0; padding: 2px 6px; border-radius: 4px; }

			/* MDX Content Styles */
			.prose-cv :global(h2) { display: none; } /* Hide the 'Experience' header since we have a custom styled one */
			.prose-cv :global(h3) { font-weight: 800; font-size: 11pt; color: var(--text-main); margin-top: 25px; margin-bottom: 4px; }
			.prose-cv :global(p) { font-size: 9.5pt; color: var(--text-muted); line-height: 1.5; margin-top: 4px; }
			.prose-cv :global(ul) { margin-top: 8px; padding-left: 15px; font-size: 9pt; color: var(--text-muted); list-style-type: disc; }
			.prose-cv :global(li) { margin-bottom: 4px; page-break-inside: avoid; }
			.prose-cv :global(strong) { color: var(--text-main); }

			.download-btn {
				position: fixed; bottom: 30px; right: 30px; background: var(--accent); color: white;
				padding: 12px 24px; border-radius: 99px; font-weight: bold; text-decoration: none;
				box-shadow: 0 4px 12px rgba(35, 55, 255, 0.3); z-index: 100;
				display: flex; align-items: center; gap: 8px; font-size: 14px;
				transition: transform 0.2s ease, background 0.2s ease;
			}
			.download-btn:hover {
				background: #1e2ecc;
				transform: translateY(-2px);
			}
		</style>
	</head>
	<body class="bg-slate-50">
		<Header class="print:hidden" />
		
		<!-- This button now points to the hosted PDF -->
		<a href="/resume-venkata-harish.pdf" download class="download-btn print:hidden">
			<svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
				<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a2 2 0 002 2h12a2 2 0 002-2v-1m-4-4l-4 4m0 0l-4-4m4 4V4" />
			</svg>
			Download PDF
		</a>

		<div class="page">
			<aside class="sidebar">
				<section>
					<h2>Contact</h2>
					<div class="contact-item"><strong>Email</strong>{frontmatter.email}</div>
					<div class="contact-item"><strong>Phone</strong>{frontmatter.phone}</div>
					<div class="contact-item"><strong>Location</strong>{frontmatter.location}</div>
					<div class="contact-item"><strong>Links</strong>
						{frontmatter.profiles.map(p => (
							<a href={p.url} target="_blank" style="display:block; color:inherit; text-decoration:none;">{p.network}: {p.url.replace('https://', '')}</a>
						))}
					</div>
				</section>

				<section style="margin-top: 30px;">
					<h2>Skills</h2>
					{frontmatter.skills.map(group => (
						<div class="skill-group">
							<div class="skill-group-title">{group.name}</div>
							<div class="skill-tags">
								{group.keywords.map(k => <span class="skill-tag">{k}</span>)}
							</div>
						</div>
					))}
				</section>

				<section style="margin-top: 30px;">
					<h2>Education</h2>
					{frontmatter.education.map(edu => (
						<div class="edu-item" style="margin-bottom: 12px;">
							<div style="font-weight: 700; font-size: 9pt; color: var(--text-main);">{edu.institution}</div>
							<div style="font-size: 8pt; color: var(--text-muted);">{edu.studyType} in {edu.area}</div>
							<div style="font-size: 8pt; color: var(--text-muted);">{edu.startDate} â€” {edu.endDate}</div>
						</div>
					))}
				</section>
			</aside>

			<div class="main-content">
				<header class="resume-header">
					<h1>{frontmatter.name.toUpperCase()}</h1>
					<div class="role-title">{frontmatter.label}</div>
				</header>

				<section>
					<h2>Professional Summary</h2>
					<p style="font-size: 9.5pt; color: var(--text-muted); line-height: 1.6; margin-top: 0;">
						{frontmatter.summary}
					</p>
				</section>

				<section class="prose-cv">
					<h2>Experience</h2>
					<slot />
				</section>
			</div>
		</div>
		<Footer class="print:hidden" />
	</body>
</html>